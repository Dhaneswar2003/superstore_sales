import pandas as pd

df = pd.read_csv("/content/sample_data/superstore_sales_dataset.csv")

df = df.drop(columns=["Unnamed: 0", "test", "cumulative_value"], errors="ignore")


df = df.drop_duplicates()

df = df.dropna()

df["Order_Date"] = pd.to_datetime(df["Order_Date"])
df["Ship_Date"] = pd.to_datetime(df["Ship_Date"])

df["Year"] = df["Order_Date"].dt.year
df["Month"] = df["Order_Date"].dt.month
df["Month_Name"] = df["Order_Date"].dt.strftime("%B")

clean_path = "/content/sample_data/superstore_sales_dataset.csv"
df.to_csv(clean_path, index=False)

clean_path

import pandas as pd

df = pd.read_csv("/content/sample_data/superstore_sales_dataset.csv")


total_sales = df["Sales"].sum()
pd.DataFrame({"Total_Sales": [total_sales]}).to_csv("/content/sample_data/superstore sales/total_sales.csv", index=False)


sales_by_category = df.groupby("Category")["Sales"].sum().reset_index()
sales_by_category.to_csv("/content/sample_data/superstore sales/sales_by_category.csv", index=False)


sales_by_region = df.groupby("Region")["Sales"].sum().reset_index()
sales_by_region.to_csv("/content/sample_data/superstore sales/sales_by_region.csv", index=False)


sales_by_segment = df.groupby("Segment")["Sales"].sum().reset_index()
sales_by_segment.to_csv("/content/sample_data/superstore sales/sales_by_segment.csv", index=False)


monthly_sales = df.groupby(["Year","Month","Month_Name"])["Sales"].sum().reset_index()
monthly_sales.to_csv("/content/sample_data/superstore sales/monthly_sales.csv", index=False)


top_10_products = df.groupby("Product_Name")["Sales"].sum().sort_values(ascending=False).head(10).reset_index()
top_10_products.to_csv("/content/sample_data/superstore sales/ top_10_products.csv", index=False)


ship_time = df.groupby("Ship_Mode")["Time_Shipped"].mean().reset_index()
ship_time.to_csv("/content/sample_data/superstore sales/shipping_time.csv", index=False)
